<div class="collaboration-details-container">
  <div class="header">
    <button mat-icon-button (click)="goBack()" class="back-button">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h1>{{ 'COLLABORATIONS.DETAILS.TITLE' | translate }}</h1>
  </div>

  <div class="content" *ngIf="!loading && !error && collaboration">
    <!-- Header Card -->
    <mat-card class="header-card">
      <mat-card-content>
        <div class="collaboration-header">
          <div class="counterpart-info">
            <img 
              [src]="getImageUrl(collaboration.counterpart.photoUrl)" 
              [alt]="collaboration.counterpart.name"
              class="counterpart-avatar"
              (error)="hideImage($event)">
            <div class="counterpart-details">
              <h2>{{ collaboration.counterpart.name }}</h2>
              <p class="role">{{ 'COLLABORATIONS.DETAILS.COUNTERPART' | translate }}</p>
            </div>
          </div>
          <div class="status-section">
            <mat-chip 
              [color]="getStatusColor(collaboration.status)" 
              selected
              class="status-chip">
              <mat-icon>{{ getStatusIcon(collaboration.status) }}</mat-icon>
              {{ 'COLLABORATIONS.STATUS.' + collaboration.status | translate }}
            </mat-chip>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Main Information -->
    <mat-card class="info-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>info</mat-icon>
          {{ 'COLLABORATIONS.DETAILS.INFORMATION' | translate }}
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          <div class="info-item">
            <label>{{ 'COLLABORATIONS.DETAILS.ACTION_TYPE' | translate }}</label>
            <span class="action-type">{{ getActionTypeLabel(collaboration.actionType) }}</span>
          </div>
          <div class="info-item">
            <label>{{ 'COLLABORATIONS.DETAILS.TARGET_DATE' | translate }}</label>
            <span>{{ formatDate(collaboration.targetDate) }}</span>
          </div>
          <div class="info-item">
            <label>{{ 'COLLABORATIONS.DETAILS.BUDGET' | translate }}</label>
            <span class="budget">${{ collaboration.budget.toFixed(2) }}</span>
          </div>
          <div class="info-item">
            <label>{{ 'COLLABORATIONS.DETAILS.LOCATION' | translate }}</label>
            <span>{{ collaboration.location }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Message -->
    <mat-card class="message-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>message</mat-icon>
          {{ 'COLLABORATIONS.DETAILS.MESSAGE' | translate }}
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class="message-text">{{ collaboration.message }}</p>
      </mat-card-content>
    </mat-card>

    <!-- Deliverables -->
    <mat-card class="deliverables-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>assignment</mat-icon>
          {{ 'COLLABORATIONS.DETAILS.DELIVERABLES' | translate }}
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class="deliverables-text">{{ collaboration.deliverables }}</p>
      </mat-card-content>
    </mat-card>

    <!-- Milestones -->
    <mat-card class="milestones-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>timeline</mat-icon>
          {{ 'COLLABORATIONS.DETAILS.MILESTONES' | translate }}
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="milestones-list" *ngIf="collaboration.milestones && collaboration.milestones.length > 0">
          <div class="milestone-item" *ngFor="let milestone of collaboration.milestones; let i = index">
            <div class="milestone-header">
              <h3>{{ milestone.title }}</h3>
              <span class="milestone-date">{{ formatDate(milestone.date) }}</span>
            </div>
            <div class="milestone-content">
              <p class="milestone-description">{{ milestone.description }}</p>
              <div class="milestone-details">
                <div class="milestone-location" *ngIf="milestone.location">
                  <mat-icon>location_on</mat-icon>
                  <span>{{ milestone.location }}</span>
                </div>
                <div class="milestone-deliverables" *ngIf="milestone.deliverables">
                  <mat-icon>assignment</mat-icon>
                  <span>{{ milestone.deliverables }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="no-milestones" *ngIf="!collaboration.milestones || collaboration.milestones.length === 0">
          <mat-icon>timeline</mat-icon>
          <p>{{ 'COLLABORATIONS.DETAILS.NO_MILESTONES' | translate }}</p>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Dates -->
    <mat-card class="dates-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>schedule</mat-icon>
          {{ 'COLLABORATIONS.DETAILS.DATES' | translate }}
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="dates-grid">
          <div class="date-item">
            <label>{{ 'COLLABORATIONS.DETAILS.CREATED_AT' | translate }}</label>
            <span>{{ formatDate(collaboration.createdAt) }}</span>
          </div>
          <div class="date-item" *ngIf="collaboration.updatedAt">
            <label>{{ 'COLLABORATIONS.DETAILS.UPDATED_AT' | translate }}</label>
            <span>{{ formatDate(collaboration.updatedAt) }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <mat-spinner diameter="50"></mat-spinner>
    <p>{{ 'COLLABORATIONS.DETAILS.LOADING' | translate }}</p>
    <small>Cargando detalles de la colaboraci√≥n...</small>
  </div>

  <!-- Error State -->
  <div class="error-container" *ngIf="error">
    <mat-icon class="error-icon">error</mat-icon>
    <h2>{{ 'COLLABORATIONS.DETAILS.ERROR_TITLE' | translate }}</h2>
    <p>{{ 'COLLABORATIONS.DETAILS.ERROR_MESSAGE' | translate }}</p>
    <button mat-raised-button color="primary" (click)="loadCollaborationDetails()">
      {{ 'COLLABORATIONS.DETAILS.RETRY' | translate }}
    </button>
  </div>
</div> 