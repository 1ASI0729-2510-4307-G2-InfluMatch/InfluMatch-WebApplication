<div class="modal-container">
  <div class="modal-header">
    <h2 mat-dialog-title>
      <mat-icon>assignment</mat-icon>
      {{ 'COLLABORATIONS.CONFIRMATION.TITLE' | translate }}
    </h2>
    <button mat-icon-button (click)="closeModal()" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <div mat-dialog-content class="modal-content">
    <!-- Loading Overlay -->
    <div class="loading-overlay" *ngIf="loading">
      <mat-spinner diameter="40"></mat-spinner>
      <p>{{ 'COLLABORATIONS.CONFIRMATION.PROCESSING' | translate }}</p>
    </div>

    <!-- Collaboration Details -->
    <div class="collaboration-details" *ngIf="!loading">
      <mat-card class="detail-card">
        <mat-card-content>
          <!-- Header with User Info -->
          <div class="user-info-section">
            <img 
              [src]="getImageUrl(collaboration.counterpartPhotoUrl)" 
              [alt]="collaboration.counterpartName"
              class="user-avatar"
              (error)="hideImage($event)">
            <div class="user-details">
              <h3>{{ collaboration.counterpartName }}</h3>
              <p class="role">{{ 'COLLABORATIONS.LIST.ROLE.' + collaboration.initiatorRole | translate }}</p>
            </div>
            <div class="status-section">
              <mat-chip 
                [color]="getStatusColor(collaboration.status)" 
                selected
                class="status-chip">
                <mat-icon>{{ getStatusIcon(collaboration.status) }}</mat-icon>
                {{ 'COLLABORATIONS.STATUS.' + collaboration.status | translate }}
              </mat-chip>
            </div>
          </div>

          <!-- Collaboration Info -->
          <div class="collaboration-info">
            <div class="info-row">
              <mat-icon>message</mat-icon>
              <div class="info-content">
                <h4>{{ 'COLLABORATIONS.CONFIRMATION.MESSAGE' | translate }}</h4>
                <p>{{ collaboration.message }}</p>
              </div>
            </div>

            <div class="info-row">
              <mat-icon>campaign</mat-icon>
              <div class="info-content">
                <h4>{{ 'COLLABORATIONS.CONFIRMATION.ACTION_TYPE' | translate }}</h4>
                <p>{{ getActionTypeLabel(collaboration.actionType) }}</p>
              </div>
            </div>

            <div class="info-row">
              <mat-icon>schedule</mat-icon>
              <div class="info-content">
                <h4>{{ 'COLLABORATIONS.CONFIRMATION.CREATED_DATE' | translate }}</h4>
                <p>{{ formatDate(collaboration.createdAt) }}</p>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Action Buttons -->
      <div class="action-buttons" *ngIf="canShowActionButton()">
        <div class="action-description">
          <mat-icon>info</mat-icon>
          <p *ngIf="userRole === 'RECIPIENT' && collaboration.status === 'PENDING'">
            {{ 'COLLABORATIONS.CONFIRMATION.RECIPIENT_DESCRIPTION' | translate }}
          </p>
          <p *ngIf="userRole === 'INITIATOR' && collaboration.status === 'PENDING'">
            {{ 'COLLABORATIONS.CONFIRMATION.INITIATOR_CANCEL_DESCRIPTION' | translate }}
          </p>
          <p *ngIf="userRole === 'INITIATOR' && collaboration.status === 'ACCEPTED'">
            {{ 'COLLABORATIONS.CONFIRMATION.INITIATOR_FINISH_DESCRIPTION' | translate }}
          </p>
        </div>

        <div class="buttons-container">
          <!-- Accept/Reject for Recipient -->
          <div *ngIf="userRole === 'RECIPIENT' && collaboration.status === 'PENDING'" class="recipient-actions">
            <button 
              mat-raised-button 
              color="primary" 
              (click)="executeAction('ACCEPT')"
              [disabled]="loading"
              class="action-button accept-button">
              <mat-icon>check</mat-icon>
              {{ 'COLLABORATIONS.ACTIONS.ACCEPT' | translate }}
            </button>
            
            <button 
              mat-raised-button 
              color="warn" 
              (click)="executeAction('REJECT')"
              [disabled]="loading"
              class="action-button reject-button">
              <mat-icon>close</mat-icon>
              {{ 'COLLABORATIONS.ACTIONS.REJECT' | translate }}
            </button>
          </div>

          <!-- Cancel for Initiator -->
          <div *ngIf="userRole === 'INITIATOR' && collaboration.status === 'PENDING'" class="initiator-actions">
            <button 
              mat-raised-button 
              color="warn" 
              (click)="executeAction('CANCEL')"
              [disabled]="loading"
              class="action-button cancel-button">
              <mat-icon>cancel</mat-icon>
              {{ 'COLLABORATIONS.ACTIONS.CANCEL' | translate }}
            </button>
          </div>

          <!-- Finish for Initiator -->
          <div *ngIf="userRole === 'INITIATOR' && collaboration.status === 'ACCEPTED'" class="initiator-actions">
            <button 
              mat-raised-button 
              color="primary" 
              (click)="executeAction('FINISH')"
              [disabled]="loading"
              class="action-button finish-button">
              <mat-icon>done_all</mat-icon>
              {{ 'COLLABORATIONS.ACTIONS.FINISH' | translate }}
            </button>
          </div>
        </div>
      </div>

      <!-- No Actions Available -->
      <div class="no-actions" *ngIf="!canShowActionButton()">
        <mat-icon>info</mat-icon>
        <p>{{ 'COLLABORATIONS.CONFIRMATION.NO_ACTIONS_AVAILABLE' | translate }}</p>
      </div>
    </div>
  </div>

  <div mat-dialog-actions class="modal-actions">
    <button mat-button (click)="closeModal()" [disabled]="loading">
      {{ 'COLLABORATIONS.CONFIRMATION.CLOSE' | translate }}
    </button>
  </div>
</div> 